#### 浏览器

​	浏览器本身是个多进程、多线程的应用。进程有如：浏览器主进程、网络通信进程、渲染进程等等......

**主要关注：渲染进程**

##### 渲染进程

​	浏览器每个标签页都会开辟一个新的渲染进程，该进程启动后产生一个渲染主进程来负责HTML、JS和CSS代码的执行工作

##### 1、执行栈：

存储函数调用的一个栈结构，后进先出。如浏览器报错时显示出来的函数调用层级

##### 2、任务队列（事件队列/消息队列）

在以前，W3C将任务队列的类型简单分为了宏任务队列和微任务队列，但目前已经开始有新的规范产生。简单来说就是分为了微任务队列（必须且优先级最高）和其他任务队列。

其他任务队列主要包含：交互任务队列(高)、延时任务队列(中)等等

###### 2.1、阐述一下JS的事件循环

事件循环又叫消息循环，是浏览器渲染主线程的工作方式。

在chrome的实现源码中，它会开启一个不会结束的for循环，每次循环会从消息队列中取出一个任务来执行，而其他线程只需要在合适的时候将任务加入到队列末尾即可。

过去把消息队列列简单分为宏任务和微任务，但目前这种说法已经无法满足复杂的浏览器环境，取而代之的是更灵活多变的模式。

根据W3C的解释，每个任务都有不同的类型，同类型的任务必须在同一个队列，不同的任务可以属于不同的队列中。不同任务队列有不同的优先级，在一次事件循环中，由浏览器自行决定去哪个队列的任务，但浏览器必须有一个微队列，微队列的任务一定具有最高优先级，必须优先调度执行。

##### 3、如何理解JS的异步

​	JS是一门单线程的语言，这是因为它运行在浏览器的渲染主进程中，渲染主进程只有一个。

而渲染主进程承担着很多的工作，页面渲染、执行JS都在其中运行。

如果使用同步的方式，就极有可能导致主线程产生阻塞，从而导致消息队列里面的很多其他任务无法得到及时的处理，这一以来，一方面会导致繁忙的主线程白白地消耗时间，另一方面导致页面无法及时地更新，给用户造成卡死现象。

所以浏览器使用异步的方式来避免，具体做法是当某些任务发生时，比如计时器、网络、事件监听、主线程将任务交给其他线程去处理，自身立即结束任务的执行，转而执行后续的代码任务。当其他线程任务完成时，**将实现传递的回调函数包装成任务，加入到消息队列的末尾排队**，等待主线程的**调度执行。**

在这种异步模式下，浏览器永远不会阻塞，从而最大限度地保证了单线程的顺畅运行。





